# 实验结果分析报告（修正版）

**实验日期**: 2025-12-27  
**结果文件**: `full_optimization_20251227_145641.json`  
**修正文件**: `full_optimization_20251227_145641_recalculated.json`  
**实验配置**: 1次运行 × 3场景 × 3实验组

---

## ⚠️ 指标修正说明

本报告使用修正后的评估指标：

| 指标 | 原定义 | 修正后定义 | 原因 |
|-----|--------|----------|------|
| **共识指数** | 1 - (max_share - min_share) | 基于信息熵 | 原定义将"完全一致"判为无共识 |
| **效率分数** | 200ms理想，2000ms为0 | 2s理想，10s为0.5，60s为0 | 原阈值对LLM不现实 |
| **决策质量** | 需要ground truth | 基于政治倾向一致性 | 原实现无法评估 |

---

## 实验配置

### 选举投票场景

| 参数 | 基线(CoT) | ToT优化 | 全优化 |
|-----|----------|---------|--------|
| 选民数量 | 30 | 30 | 30 |
| 辩论轮次 | 3 | 3 | 3 |
| use_tot | ❌ | ✅ | ✅ |
| use_enhanced_memory | ❌ | ❌ | ✅ |
| use_dynamic_reflection | ❌ | ❌ | ✅ |
| use_collaborative | ❌ | ❌ | ✅ |

### 资源分配场景

| 参数 | 基线(CoT) | ToT优化 | 全优化 |
|-----|----------|---------|--------|
| 智能体数量 | 20 | 20 | 20 |
| 总资源量 | 500 | 500 | 500 |
| 最大轮次 | 5 | 5 | 5 |
| use_tot | ❌ | ✅ | ✅ |

### 信息传播场景

| 参数 | 基线(CoT) | ToT优化 | 全优化 |
|-----|----------|---------|--------|
| 智能体数量 | 50 | 50 | 50 |
| 传播轮次 | 10 | 10 | 10 |
| use_tot | ❌ | ✅ | ✅ |

---

## 场景一：选举投票

### 投票结果

| 指标 | 基线(CoT) | ToT优化 | 全优化 |
|-----|----------|---------|--------|
| Biden 支持 | 8 | 10 | 9 |
| Trump 支持 | 9 | 8 | 8 |
| Undecided | 13 | 12 | 13 |

### 评估指标（修正后）

| 指标 | 基线(CoT) | ToT优化 | 全优化 | 说明 |
|-----|----------|---------|--------|------|
| 推理能力分 | 0.47 | **0.94** | **0.95** | ToT显著提升 |
| 效率分数 | **0.77** | 0.00 | 0.00 | ToT耗时太长 |
| 共识指数(修正) | 0.01 | 0.02 | 0.02 | 三方分散无共识 |
| 社会效应分 | **0.58** | 0.57 | 0.57 | 基线略高 |
| **综合分** | **0.58** | 0.50 | 0.50 | 基线反超 |

### 指标变化对比

| 指标 | 基线(旧→新) | ToT(旧→新) | 全优化(旧→新) |
|-----|------------|-----------|--------------|
| 共识指数 | 0.87→0.01 | 0.83→0.02 | 0.83→0.02 |
| 效率分数 | 0.00→0.77 | 0.00→0.00 | 0.00→0.00 |
| 社会效应分 | 0.92→0.58 | 0.89→0.57 | 0.89→0.57 |
| 综合分 | 0.47→**0.58** | 0.58→0.50 | 0.58→0.50 |

**关键发现**：
- 修正后共识指数从 0.8+ 降到 ~0.02（三方分散确实无共识）
- 基线组因效率高（5.6s）获得 0.77 效率分
- ToT组因耗时太长（670s）效率分为 0
- **综合分排名逆转**：基线 > ToT

---

## 场景二：资源分配

### 分配结果

| 指标 | 基线(CoT) | ToT优化 | 全优化 |
|-----|----------|---------|--------|
| 协商轮次 | 2 | 2 | 2 |
| Gini系数 | 0.069 | **0.059** | 0.060 |
| 平均满意度 | 0.61 | **0.73** | 0.69 |
| 资源利用率 | 0.86 | **0.90** | 0.89 |

### 评估指标（修正后）

| 指标 | 基线(CoT) | ToT优化 | 全优化 |
|-----|----------|---------|--------|
| 推理能力分 | 0.49 | **0.67** | **0.67** |
| 效率分数 | **0.96** | 0.75 | 0.74 |
| 社会效应分 | 0.50 | 0.50 | 0.50 |
| **综合分** | **0.61** | 0.61 | 0.60 |

### 指标变化对比

| 指标 | 基线(旧→新) | ToT(旧→新) | 全优化(旧→新) |
|-----|------------|-----------|--------------|
| 效率分数 | 0.00→0.96 | 0.00→0.75 | 0.00→0.74 |
| 综合分 | 0.37→**0.61** | 0.42→0.61 | 0.42→0.60 |

**关键发现**：
- 基线组因快速响应（2.6s）效率分最高
- ToT组在公平性和满意度上仍有优势
- 综合分三组基本持平

---

## 场景三：信息传播

### 传播结果

| 指标 | 基线(CoT) | ToT优化 | 全优化 |
|-----|----------|---------|--------|
| 虚假信念率 | 5.7% | **0%** | **0%** |
| 真实信息传播 | **74%** | 62% | 50% |
| 信息接收量 | 44 | 28 | 18 |

### 评估指标（修正后）

| 指标 | 基线(CoT) | ToT优化 | 全优化 |
|-----|----------|---------|--------|
| 推理能力分 | 0.46 | **0.69** | **0.69** |
| 效率分数 | **1.00** | 0.88 | 0.88 |
| 社会效应分 | 0.50 | 0.50 | 0.50 |
| **综合分** | 0.62 | **0.64** | **0.64** |

### 指标变化对比

| 指标 | 基线(旧→新) | ToT(旧→新) | 全优化(旧→新) |
|-----|------------|-----------|--------------|
| 效率分数 | 0.09→1.00 | 0.00→0.88 | 0.00→0.88 |
| 综合分 | 0.39→0.62 | 0.42→**0.64** | 0.42→**0.64** |

**关键发现**：
- 基线组效率最高（1.8s），但综合分仍低于ToT
- ToT/全优化组在推理能力上优势明显
- ToT/全优化完全阻止虚假信息（虚假信念率=0）

---

## 综合对比（修正后）

### 综合分数对比

| 场景 | 基线(CoT) | ToT优化 | 全优化 | 最佳 |
|-----|----------|---------|--------|------|
| 选举 | **0.58** | 0.50 | 0.50 | 基线 |
| 资源 | **0.61** | 0.61 | 0.60 | 基线≈ToT |
| 信息 | 0.62 | **0.64** | **0.64** | ToT/全优化 |

### 各维度对比

| 维度 | 基线(CoT) | ToT优化 | 全优化 |
|-----|----------|---------|--------|
| 推理能力 | 0.47 | **0.77** | **0.77** |
| 计算效率 | **0.91** | 0.54 | 0.54 |
| 社会效应 | **0.53** | 0.52 | 0.52 |

### 关键洞察

| 发现 | 说明 |
|-----|------|
| **ToT推理能力提升明显** | 平均提升 63%（0.47→0.77） |
| **ToT计算成本高** | 选举场景耗时增加 120x |
| **权衡明显** | 推理质量 vs 计算效率 |
| **全优化未超ToT** | 额外优化机制未充分发挥 |

---

## 核心结论

### ✅ 修正后的可靠结论

1. **ToT 显著提升推理能力**
   - 推理深度：2层 → 5层
   - 推理多样性：1分支 → 40分支
   - 连贯性分数：0.5 → 0.8

2. **ToT 计算成本显著增加**
   - 选举场景：5.6s → 670s（120x）
   - 资源场景：2.6s → 6.0s（2.3x）
   - 信息场景：1.8s → 3.9s（2.1x）

3. **任务类型决定最优配置**
   - 需要快速响应：选择 CoT
   - 需要高质量推理：选择 ToT
   - 需要抵抗虚假信息：选择 ToT

### ⚠️ 原结论的修正

| 原结论 | 修正后 |
|-------|-------|
| ToT综合分更高 | 基线在选举/资源场景综合分更高或持平 |
| 共识度高达0.8+ | 实际共识度接近0（三方分散） |
| ToT全面优于基线 | ToT在推理能力上优势明显，但牺牲效率 |

---

## 各场景推荐配置

| 场景 | 推荐配置 | 原因 |
|-----|---------|------|
| **选举投票** | 基线 CoT | 效率高，综合分最佳 |
| **资源分配** | ToT 优化 | 公平性和满意度最高 |
| **信息传播** | ToT 优化 | 完美抵抗虚假信息 |

---

## 改进建议

### 短期

1. **选举场景**：增加辩论轮次到6轮，观察共识是否形成
2. **ToT优化**：调整 beam_width 和 max_depth 降低计算成本
3. **全优化组**：增加模拟轮次让记忆/反思机制发挥作用

### 中期

1. **多次运行**：增加到 3-5 次运行获得统计意义
2. **参数调优**：对推理深度、分支数进行敏感性分析
3. **成本-收益曲线**：绘制推理质量 vs 计算成本的权衡曲线

---

## 技术细节

### 指标修正代码

**共识指数（信息熵方法）**：
```python
def calculate_consensus_entropy(distribution):
    total = sum(distribution.values())
    entropy = 0
    for count in distribution.values():
        if count > 0:
            p = count / total
            entropy -= p * math.log2(p)
    max_entropy = math.log2(len(distribution))
    return 1 - (entropy / max_entropy)
```

**效率分数（合理阈值）**：
```python
def calculate_efficiency_score(avg_duration_ms):
    if avg_duration_ms <= 2000:
        return 1.0
    elif avg_duration_ms <= 10000:
        return 1.0 - (avg_duration_ms - 2000) / 16000
    elif avg_duration_ms <= 60000:
        return 0.5 - (avg_duration_ms - 10000) / 100000
    else:
        return 0.0
```

---

*报告生成时间: 2025-12-27*  
*使用模型: GPT-4o-mini*  
*实验框架: Casevo v1.0*  
*指标修正版本: v2*
